language: java
jdk:
  - oraclejdk8

sudo: false
install: true

script:
  - ./gradlew war
  - ./gradlew test

notifications:
  email:
    recipients:
      - sharma.j@husky.neu.edu

after_success:
  - mkdir codedeploy
  - zip -r SimpleJavaProject-${TRAVIS_JOB_NUMBER}.zip build/libs/Root.war appspec.yml
  - ls -al
  - mv SimpleJavaProject-${TRAVIS_JOB_NUMBER}.zip codedeploy/
  - ls -al
  - pwd
  - cd codedeploy
  - ls -al
  - pwd

before_deploy:
  - cd ..

deploy:
  - provider: s3
    access_key_id: AKIAIUZLVF7ZPZTBUC5Q
    secret_access_key:
      secure: "qke+aKt5AxaqbLzmZR6qtFbD+8fQKXzAs4tw4pt+Lm0BHaA5xOtzZUroz0fsDSt16WxdtuiiZHJrhpPcGxstH3S5B0vWEjVOJXhoYivAvnc2pCPcIXPXElu0OUfS2Pho48IsWKac6u9rVQgrnky7t4mnzPpMcUFV94i98wQ1wPimhtfEnhpWdkU91nXQoGwI8BDJm26PG/V/mnDWl7SzSSrWfbtZLrheo90GI1ton6DxWJ/su8BObZzu7HwmiRPtsRuOBguW8/7dv/AXqiWns1AGxBI1CSwbeToNL27TxPsQogBoSm6mPnoENibZhANGkySGaPk4fdA4CN0v8PJoikOnHvsDHHi85iCpTIHiEx0QXcXmLZfgkB5aufXhg/iESX8gxWQneef95JJj+VGr/27LqwDxa0UvesXCTqyYQjmASxwXe/hXwJGguUISv5DX5qA8LsevIeNRc5Dq7WBpwkpaSaWZ36HLkL11tqlMCHxc3AbGvPXhaza61hGpsTXQh/QgT/4tsVmGpJEYkDNkTw03dnxv4miLzjd9foFnuo63AHUkGxVFpVcko0fuII3PqPuw6uiEr3wi18Af0/5GKI0XwYj++F8kmIlp6JNRV/hFFqdDK12M6i0dbMZzXCnSPllYqHM9rxE8D87sOR+nXQjbTocfUmeN4rnrx/kpTzA="
    local_dir: codedeploy
    bucket: code-deploy.csye6225-fall2017-muralia.me
    region: us-east-1
    skip_cleanup: true
